import{S as $o,E as Xo,o as Yo,a as qo,r as i,B as Jo,d as Ln,j as n,F,D as Zo,u as ut,b as pt,i as ae,e as An,s as W,f as j,_ as Qo,P as Le,g as _e,h as Me,k as nt,l as we,m as V,n as ea,p as x,q as jn,t as zn,v as Ae,w as ta,x as Ce,y as le,z as ot,A as na,C as oa,G as aa,H as sa,I as ia,J as Pe,K as ra,L as H,M as ca,N as ht,O as mt,Q as de,R as la,T as da,U as Ht,V as ua,W as pa,X as ha,Y as oe,Z as G,$ as T,a0 as R,a1 as ue,a2 as J,a3 as ft,a4 as Bn,a5 as ma,a6 as te,a7 as fa,a8 as ga,a9 as Ie,aa as gt,ab as Nn,ac as xe,ad as ba,ae as fe,af as je,ag as va,ah as Wn,ai as ya,aj as Pa,ak as xa,al as Ee,am as Sa,an as me,ao as ke,ap as _a,aq as ze,ar as wa,as as Fn,at as Ca,au as Ia,av as Ea,aw as Vn,ax as ka,ay as bt,az as Ut,aA as Ta,aB as vt,aC as Ma,aD as Da,aE as at,aF as Hn,aG as Ra,aH as Oa,aI as La,aJ as Aa,aK as ja,aL as za,aM as Ba,aN as Na,aO as ne,aP as Be,aQ as Un,aR as Ne,aS as Wa,aT as yt,aU as Pt,aV as Fa,aW as Va,aX as Gn,aY as Ha,aZ as Ua,a_ as Ga,a$ as Kn,b0 as $n,b1 as Gt,b2 as Ka,b3 as $a,b4 as ee,b5 as Xn,b6 as Xa,b7 as Yn,b8 as st,b9 as Ya,ba as qa,bb as Ja,bc as qn,bd as Jn,be as Za,bf as Qa,bg as es,bh as Zn,bi as ts,bj as ns,bk as Qn,bl as xt,bm as os,bn as Je,bo as as,bp as ss,bq as is,br as Kt,bs as rs,bt as cs,bu as Ze,bv as ls,bw as it,bx as rt,by as eo,bz as ds,bA as us,bB as ps,bC as hs,bD as ms,bE as fs,bF as to,bG as gs,bH as St,bI as bs,bJ as vs,bK as ys,bL as Ps,bM as xs,bN as Ss,bO as _s,bP as ws,bQ as Cs,bR as Is,bS as ct,bT as no,bU as Es,bV as ks,bW as Ts,bX as Ms,bY as Ds,bZ as lt,b_ as Rs,b$ as Os,c0 as Ls,c1 as Qe,c2 as $t,c3 as As,c4 as js,c5 as oo,c6 as zs,c7 as Bs,c8 as Ns,c9 as Ws,ca as et,cb as Xt,cc as Fs,cd as Yt,ce as Vs}from"./sanity-dfa80759.js";import{h as Hs,j as Us}from"./index-25f114cf.js";function ao(t,e){var o=typeof e=="object";return new Promise(function(s,a){var c=new $o({next:function(r){s(r),c.unsubscribe()},error:a,complete:function(){o?s(e.defaultValue):a(new Xo)}});t.subscribe(c)})}function Gs(){return Yo(function(t,e){var o,s=!1;t.subscribe(qo(e,function(a){var c=o;o=a,s&&e.next([c,a]),s=!0}))})}function Ks(t,e){var o=i.useCallback(function(){var r=new Jo(t),l=r.asObservable().pipe(Ln());return[e?l.pipe(e):l,r]},[]),s=i.useRef();s.current||(s.current=o());var a=s.current[0];i.useEffect(function(){if(s.current){var r=s.current,l=r[1];l.next(t)}},[t,s]);var c=i.useRef(!1);return i.useEffect(function(){return c.current&&(s.current||(s.current=o()),c.current=!1),function(){if(s.current){c.current=!0;var r=s.current,l=r[1];l.complete(),s.current=void 0}}},[]),a}var qt,Jt,Zt,Qt,en,tn,nn,on,an,sn,rn,cn,ln,dn,un,pn,hn,mn,fn,gn,bn,vn,yn,Pn,xn,Sn;function z(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function so(t){let{children:e,ms:o=0}=t;const[s,a]=i.useState(o<=0);return i.useEffect(()=>{if(o<=0)return;const c=setTimeout(()=>a(!0),o);return()=>{clearTimeout(c)}},[o]),!s||!e?n(F,{}):typeof e=="function"?e():e}const _t=t=>{const{actions:e,children:o,actionProps:s,onActionComplete:a}=t;return n(Hn,{onReset:a,hooks:e,args:s,children:o})},$s=t=>{const{badges:e,children:o,badgeProps:s,...a}=t;return n(Hn,{...a,hooks:e,args:s,children:o})},Xs=[];function Ys(t){const{children:e,flatIndex:o,index:s,params:a,payload:c,siblingIndex:r}=t,{navigate:l,navigateIntent:d}=ut(),u=pt(),h=i.useMemo(()=>(u==null?void 0:u.panes)||Xs,[u==null?void 0:u.panes]),p=s-1,g=i.useCallback(b=>{const f=h[p]||[],P=f[r],S=b(f,P),_=[...h.slice(0,p),S,...h.slice(p+1)],C={...u||{},panes:_};return setTimeout(()=>l(C),0),C},[p,l,h,u,r]),m=i.useCallback(b=>{g((f,P)=>[...f.slice(0,r),{...P,payload:b},...f.slice(r+1)])},[g,r]),v=i.useCallback(b=>{g((f,P)=>[...f.slice(0,r),{...P,params:b},...f.slice(r+1)])},[g,r]),y=i.useCallback(b=>{let{id:f,parentRefPath:P,type:S,template:_}=b;l({panes:[...h.slice(0,p+1),[{id:f,params:{template:_.id,parentRefPath:Ra(P),type:S},payload:_.params}]]})},[p,l,h]),w=i.useMemo(()=>({index:o,groupIndex:p,siblingIndex:r,payload:c,params:a,hasGroupSiblings:h[p]?h[p].length>1:!1,groupLength:h[p]?h[p].length:0,routerPanesState:h,ChildLink:Oa,BackLink:La,ReferenceChildLink:Aa,handleEditReference:y,ParameterizedLink:ja,replaceCurrent:function(){let b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};g(()=>[{id:b.id||"",payload:b.payload,params:b.params||{}}])},closeCurrent:()=>{g((b,f)=>b.length>1?b.filter(P=>P!==f):b)},duplicateCurrent:b=>{g((f,P)=>{const S={...P,payload:(b==null?void 0:b.payload)||P.payload,params:(b==null?void 0:b.params)||P.params};return[...f.slice(0,r),S,...f.slice(r)]})},setView:b=>{const f=ht(a,"view");return v(b?{...f,view:b}:f)},setParams:v,setPayload:m,navigateIntent:d}),[o,p,y,g,d,a,c,h,v,m,r]);return n(za.Provider,{value:w,children:e})}function qs(t,e,o,s){var a,c;const r={flex:t.left.flex+t.right.flex,width:t.left.width+t.right.width},l=(a=e.minWidth)!=null?a:lt,d=(c=o.minWidth)!=null?c:lt,u=Math.min(e.maxWidth||1/0,r.width-d),h=Math.min(o.maxWidth||1/0,r.width-l);let p=l-t.left.width;const g=t.right.width-h;p<g&&(p=g);let m=t.right.width-d;const v=u-t.left.width;m>v&&(m=v);const y=Math.min(Math.max(s,p),m),w=t.left.width+y,b=t.right.width-y,f=w/r.width*r.flex,P=b/r.width*r.flex;return{leftFlex:f,leftW:w,rightFlex:P,rightW:b}}function Js(t,e){const o=[];let s=e;for(;s!==t;){const a=s.parentElement;if(!a)return o;const r=Array.from(a.childNodes).indexOf(s);if(o.unshift(r),a===t)return o;s=a}return o}const _n=[];function Zs(t,e){const o=new WeakMap;for(const a of e)o.set(a,Js(t,a));const s=(a,c)=>{const r=o.get(a)||_n,l=o.get(c)||_n,d=Math.max(r.length,l.length);for(let u=0;u<d;u+=1){const h=r[u]||-1,p=l[u]||-1;if(h!==p)return h-p}return 0};e.sort(s)}function Qs(){const t=[],e=[],o=new WeakMap,s=new Set,a={};let c=null,r=0,l=null,d=new Map,u=!1;function h(f){s.add(f),l===f&&(l=null),b()}function p(f){s.delete(f),l=f,b()}function g(f,P){return o.set(f,{...P,original:P}),e.push(f),c&&Zs(c,e),p(f),()=>{const S=e.indexOf(f);S>-1&&e.splice(S,1),o.delete(f),b()}}function m(f,P,S){var _,C,M,I;const E=e.indexOf(P),O=o.get(P);if(!O)return;const D=e[E+1],B=o.get(D);if(B){if(f==="start"&&(u=!0,a.left={element:P,flex:O.flex||1,width:P.offsetWidth},a.right={element:D,flex:B.flex||1,width:D.offsetWidth},b()),f==="move"&&a.left&&a.right){d=new Map;const{leftW:L,rightW:N,leftFlex:X,rightFlex:K}=qs(a,O,B,S);d.set(P,{flex:X,width:L}),d.set(D,{flex:K,width:N}),b()}if(f==="end"){u=!1;const L=d.get(P),N=d.get(D);o.set(P,{...O,currentMinWidth:0,currentMaxWidth:(_=O.maxWidth)!=null?_:1/0,flex:(C=L==null?void 0:L.flex)!=null?C:O.flex}),o.set(D,{...B,currentMinWidth:0,currentMaxWidth:(M=O.maxWidth)!=null?M:1/0,flex:(I=N==null?void 0:N.flex)!=null?I:B.flex}),d=new Map,delete a.left,delete a.right,b()}}}function v(f){c=f}function y(f){r=f,b()}function w(f){return t.push(f),()=>{const P=t.push(f);P>-1&&t.splice(P,1)}}return{collapse:h,expand:p,mount:g,resize:m,setRootElement:v,setRootWidth:y,subscribe:w};function b(){var f,P,S,_;if(!r)return;const C=[];for(const L of e)L!==l&&C.unshift(L);l&&C.unshift(l);const M=new WeakMap,I=C.length,E=C[0],O=(I-1)*et;let D=r-O;for(const L of C){const N=o.get(L);if(!N)continue;const X=N.currentMinWidth||N.minWidth||lt,K=L===E,A=s.has(L),q=X>D,Z=K?!1:A||q,Q=d.get(L);M.set(L,{element:L,collapsed:Z,currentMinWidth:(f=Q==null?void 0:Q.width)!=null?f:N.currentMinWidth,currentMaxWidth:(P=Q==null?void 0:Q.width)!=null?P:N.currentMaxWidth,flex:(_=(S=Q==null?void 0:Q.flex)!=null?S:N.flex)!=null?_:1}),Z?D-=et:D-=X-et}const B=[];for(const L of e){const N=M.get(L);N&&B.push(N)}for(const L of t)L({expandedElement:l||e[e.length-1]||null,panes:B,resizing:u})}}function ei(t){const{children:e,minWidth:o,onCollapse:s,onExpand:a,...c}=t,r=i.useMemo(()=>Qs(),[]),[l,d]=i.useState(null),u=ze(l),h=(u==null?void 0:u.width)||0,p=h===void 0||!o?void 0:h<o,[g,m]=i.useState({expandedElement:null,panes:[],resizing:!1});i.useEffect(()=>r.setRootElement(l),[r,l]),i.useEffect(()=>r.setRootWidth(h),[r,h]),i.useEffect(()=>r.subscribe(m),[r]),i.useEffect(()=>{p!==void 0&&(p&&s&&s(),!p&&a&&a())},[p,s,a]);const v=i.useMemo(()=>({collapse:r.collapse,collapsed:p,expand:r.expand,expandedElement:g.expandedElement,mount:r.mount,panes:g.panes,resize:r.resize,resizing:g.resizing}),[p,r,g.expandedElement,g.panes,g.resizing]);return n(Ba.Provider,{value:v,children:n(Na,{"data-ui":"PaneLayout",...c,"data-collapsed":p?"":void 0,"data-resizing":g.resizing?"":void 0,"data-mounted":h?"":void 0,ref:d,children:e})})}class ge extends Error{constructor(e){let{message:o,context:s,helpId:a,cause:c}=e;super(o),this.context=s,this.helpId=a,this.cause=c}}const wn=new WeakMap;function We(t){const e=wn.get(t);if(e)return e;const o=Bs();return wn.set(t,o),o}const Cn=new WeakMap;function io(t,e){const o=Cn.get(t)||new Map;if(o){const c=o.get(e);if(c)return c}const s=t[e];if(typeof s!="function")throw new Error("Expected property `".concat(e,"` to be a function but got ").concat(typeof s," instead."));const a=s.bind(t);return o.set(e,a),Cn.set(t,o),a}const ti=t=>!!t&&typeof(t==null?void 0:t.then)=="function",ni=t=>ae(t)?typeof t.serialize=="function":!1,oi=t=>(e,o,s)=>{try{return t(e,o,s)}catch(a){throw a instanceof ge?a:new ge({message:typeof(a==null?void 0:a.message)=="string"?a.message:"",context:o,cause:a})}},ai=t=>function(){return t(...arguments).pipe(Ns(1),Ws())};function ro(t){const e=oi(ai(t((o,s,a)=>{if(!o)throw new ge({message:"Pane returned no child",context:s,helpId:"structure-item-returned-no-child"});return ti(o)||Rs(o)?to(o).pipe(Ne(c=>e(c,s,a))):ni(o)?e(o.serialize(s),s,a):typeof o=="function"?e(o(s.id,s),s,a):ee(o)})));return e}async function si(t){const e=new Map,s=ro(d=>(u,h,p)=>{const g=u&&"".concat(We(u),"-").concat(h.path.join("__")),m=g&&e.get(g);if(m)return m;const v=d(u,h,p);return g&&e.set(g,v),v}),a=[[{id:"__edit__".concat(t.params.id),params:{...ht(t.params,["id"]),type:t.params.type},payload:t.payload}]];async function c(d){let{currentId:u,flatIndex:h,intent:p,params:g,parent:m,path:v,payload:y,unresolvedPane:w,levelIndex:b,structureContext:f}=d;var P;if(!w)return[];const{id:S,type:_,...C}=g,I=await ao(s(w,{id:u,splitIndex:0,parent:m,path:v,index:h,params:{},payload:void 0,structureContext:f},h));return I.type==="document"&&I.id===S?[{panes:[...v.slice(0,v.length-1).map(E=>[{id:E}]),[{id:S,params:C,payload:y}]],depthIndex:v.length,levelIndex:b}]:(P=I.canHandleIntent)!=null&&P.call(I,p,g,{pane:I,index:h})||I.type==="documentList"&&I.schemaTypeName===_&&I.options.filter==="_type == $type"?[{panes:[...v.map(E=>[{id:E}]),[{id:g.id,params:C,payload:y}]],depthIndex:v.length,levelIndex:b}]:I.type==="list"&&I.child&&I.items?(await Promise.all(I.items.map((E,O)=>E.type==="divider"?Promise.resolve([]):c({currentId:E._id||E.id,flatIndex:h+1,intent:p,params:g,parent:I,path:[...v,E.id],payload:y,unresolvedPane:typeof I.child=="function"?io(I,"child"):I.child,levelIndex:O,structureContext:f})))).flat():[]}const l=(await c({currentId:"root",flatIndex:0,levelIndex:0,intent:t.intent,params:t.params,parent:null,path:[],payload:t.payload,unresolvedPane:t.rootPaneNode,structureContext:t.structureContext})).sort((d,u)=>d.depthIndex===u.depthIndex?d.levelIndex-u.levelIndex:d.depthIndex-u.depthIndex)[0];return l?l.panes:a}function se(){const t=i.useContext(Zo);if(!t)throw new Error("DeskTool: missing context value");return t}const ii=(t,e)=>{const o=t.replace(/^__edit__/,""),{params:s,payload:a,structureContext:{resolveDocumentNode:c}}=e,{type:r,template:l}=s;if(!r)throw new Error("Document type for document with ID ".concat(o," was not provided in the router params."));let d=c({schemaType:r,documentId:o});return d=d.id("editor").title("Editor"),l&&(d=d.initialValueTemplate(l,a)),d.serialize()};function ri(t){var e,o;return"contextHash(".concat(JSON.stringify({id:t.id,parentId:parent&&We(parent),path:t.path,index:t.index,splitIndex:t.splitIndex,serializeOptionsIndex:(e=t.serializeOptions)==null?void 0:e.index,serializeOptionsPath:(o=t.serializeOptions)==null?void 0:o.path}),")")}const In=t=>{const e={type:t.type,id:t.routerPaneSibling.id,params:t.routerPaneSibling.params||{},payload:t.routerPaneSibling.payload||null,flatIndex:t.flatIndex,groupIndex:t.groupIndex,siblingIndex:t.siblingIndex,path:t.path,paneNode:t.type==="resolvedMeta"?We(t.paneNode):null};return"metaHash(".concat(JSON.stringify(e),")")};function De(t){let{unresolvedPane:e,flattenedRouterPanes:o,parent:s,path:a,resolvePane:c,structureContext:r}=t;const[l,...d]=o,u=d[0],h={id:l.routerPaneSibling.id,splitIndex:l.siblingIndex,parent:s,path:[...a,l.routerPaneSibling.id],index:l.flatIndex,params:l.routerPaneSibling.params||{},payload:l.routerPaneSibling.payload,structureContext:r};try{return c(e,h,l.flatIndex).pipe(Ne(p=>{const g={type:"resolvedMeta",...l,paneNode:p,path:h.path},m=d.map((y,w)=>({type:"loading",path:[...h.path,...d.slice(w).map((P,S)=>"[".concat(y.flatIndex+S,"]"))],paneNode:null,...y}));if(!d.length)return ee([g]);let v;return u!=null&&u.routerPaneSibling.id.startsWith("__edit__")?v=De({unresolvedPane:ii,flattenedRouterPanes:d,parent:s,path:h.path,resolvePane:c,structureContext:r}):l.groupIndex===(u==null?void 0:u.groupIndex)?v=De({unresolvedPane:e,flattenedRouterPanes:d,parent:s,path:a,resolvePane:c,structureContext:r}):v=De({unresolvedPane:typeof p.child=="function"?io(p,"child"):p.child,flattenedRouterPanes:d,parent:p,path:h.path,resolvePane:c,structureContext:r}),Xn(ee([g,...m]),v.pipe(ne(y=>[g,...y])))}))}catch(p){if(p instanceof ge&&(p.context&&console.warn("Pane resolution error at index ".concat(p.context.index).concat(p.context.splitIndex>0?" for split pane index ".concat(p.context.splitIndex):"",": ").concat(p.message).concat(p.helpId?" - see ".concat(eo(p.helpId)):""),p),p.helpId==="structure-item-returned-no-child"))return ee([]);throw p}}function ci(t){let{routerPanesStream:e,rootPaneNode:o,initialCacheState:s={cacheKeysByFlatIndex:[],flattenedRouterPanes:[],resolvedPaneCache:new Map,resolvePane:()=>Os},structureContext:a}=t;return e.pipe(ne(r=>[[{id:"root"}],...r]),ne(r=>r.flatMap((d,u)=>d.map((h,p)=>({routerPaneSibling:h,groupIndex:u,siblingIndex:p}))).map((d,u)=>({...d,flatIndex:u}))),is([]),Gs(),ne(r=>{let[l,d]=r;for(let u=0;u<d.length;u++){const h=l[u],p=d[u];if(!nt(h,p))return{flattenedRouterPanes:d,diffIndex:u}}return{flattenedRouterPanes:d,diffIndex:d.length}}),Kt((r,l)=>{const{cacheKeysByFlatIndex:d,resolvedPaneCache:u}=r,{flattenedRouterPanes:h,diffIndex:p}=l,g=d.slice(0,p+1),m=d.slice(p+1),v=new Set(g.flatMap(b=>Array.from(b))),y=m.flatMap(b=>Array.from(b)).filter(b=>!v.has(b));for(const b of y)u.delete(b);return{flattenedRouterPanes:h,cacheKeysByFlatIndex:d,resolvedPaneCache:u,resolvePane:ro(b=>(f,P,S)=>{const _=f&&"".concat(We(f),"-").concat(ri(P)),C=_&&u.get(_);if(C)return C;const M=b(f,P,S);if(!_)return M;const I=d[S]||new Set;return I.add(_),d[S]=I,u.set(_,M),M})}},s),Ne(r=>{let{flattenedRouterPanes:l,resolvePane:d}=r;return De({unresolvedPane:o,flattenedRouterPanes:l,parent:null,path:[],resolvePane:d,structureContext:a})})).pipe(Kt((r,l)=>l.map((d,u)=>{const h=r[u];return!h||d.type!=="loading"?d:h.routerPaneSibling.id===d.routerPaneSibling.id?h:d}),[]),Ln((r,l)=>{if(r.length!==l.length)return!1;for(let d=0;d<l.length;d++){const u=r[d],h=l[d];if(In(u)!==In(h))return!1}return!0}))}function li(){const t=i.useMemo(()=>new rs(1),[]),e=i.useMemo(()=>t.asObservable().pipe(ne(s=>(s==null?void 0:s.panes)||[])),[t]),{state:o}=ut();return i.useEffect(()=>{t.next(o)},[o,t]),e}function di(){const[t,e]=i.useState();if(t)throw t;const{structureContext:o,rootPaneNode:s}=se(),[a,c]=i.useState({paneDataItems:[],resolvedPanes:[],routerPanes:[]}),r=li();return i.useEffect(()=>{const d=ci({rootPaneNode:s,routerPanesStream:r,structureContext:o}).pipe(ne(u=>{const h=u.reduce((m,v)=>{const y=m[v.groupIndex]||[];return y[v.siblingIndex]=v.routerPaneSibling,m[v.groupIndex]=y,m},[]),p=h.length,g=u.map(m=>{var v;const{groupIndex:y,flatIndex:w,siblingIndex:b,routerPaneSibling:f,path:P}=m,S=f.id,_=h[y+1];return{active:y===p-2,childItemId:(v=_==null?void 0:_[0].id)!=null?v:null,index:w,itemId:f.id,groupIndex:y,key:"".concat(m.type==="loading"?"unknown":m.paneNode.id,"-").concat(S,"-").concat(b),pane:m.type==="loading"?at:m.paneNode,params:f.params||{},path:P.join(";"),payload:f.payload,selected:w===u.length-1,siblingIndex:b}});return{paneDataItems:g,routerPanes:h,resolvedPanes:g.map(m=>m.pane)}})).subscribe({next:u=>c(u),error:u=>e(u)});return()=>d.unsubscribe()},[s,r,o]),a}async function ui(t,e,o){if(e&&o)return{id:e,type:o};if(!e&&o)return{id:cs(),type:o};if(e&&!o){const s=await ao(t.resolveTypeForDocument(e));return{id:e,type:s}}throw new ge({message:"Neither document `id` or `type` was provided when trying to resolve intent."})}const pi={},hi=i.memo(function(){const{navigate:e}=ut(),o=pt(i.useCallback(d=>{const u=typeof d.intent=="string"?d.intent:void 0;return u?{intent:u,params:ae(d.params)?d.params:pi,payload:d.payload}:void 0},[])),{rootPaneNode:s,structureContext:a}=se(),c=An(),[r,l]=i.useState(null);if(r)throw r;return i.useEffect(()=>{if(o){const{intent:d,params:u,payload:h}=o;let p=!1;async function g(){const{id:m,type:v}=await ui(c,typeof u.id=="string"?u.id:void 0,typeof u.type=="string"?u.type:void 0);if(p)return;const y=await si({intent:d,params:{...u,id:m,type:v},payload:h,rootPaneNode:s,structureContext:a});p||e({panes:y},{replace:!0})}return g().catch(l),()=>{p=!0}}},[c,o,e,s,a]),null}),mi=W.span(qt||(qt=z([`
  &:not(:last-child)::after {
    content: ' ➝ ';
    opacity: 0.5;
  }
`])));function fi(t){return t.replace(/\(\.\.\.\)\./g,`(...)
  .`).replace(/__WEBPACK_IMPORTED_MODULE_\d+_+/g,"").replace(/___default\./g,".").replace(new RegExp(" \\(https?:\\/\\/".concat(window.location.host),"g")," (")}function gi(t){let{error:e}=t;if(!(e instanceof ge))throw e;const{cause:o}=e,s=(o==null?void 0:o.stack)||e.stack,a=s&&!(o instanceof Ze)&&!e.message.includes("Module build failed:"),c=o instanceof Ze?o.path:[],r=o instanceof Ze&&o.helpId||e.helpId,l=i.useCallback(()=>{window.location.reload()},[]);return n(te,{height:"fill",overflow:"auto",padding:4,sizing:"border",tone:"critical",children:x(Ie,{children:[n(ls,{as:"h2",children:"Encountered an error while reading structure"}),x(te,{marginTop:4,padding:4,radius:2,overflow:"auto",shadow:1,tone:"inherit",children:[c.length>0&&x(J,{space:2,children:[n(it,{children:"Structure path"}),n(rt,{children:c.slice(1).map((d,u)=>n(mi,{children:d},"".concat(d,"-").concat(u)))})]}),x(J,{marginTop:4,space:2,children:[n(it,{children:"Error"}),n(rt,{children:a?fi(s):e.message})]}),r&&n(T,{marginTop:4,children:n(R,{children:n("a",{href:eo(r),rel:"noopener noreferrer",target:"_blank",children:"View documentation"})})}),n(T,{marginTop:4,children:n(G,{text:"Reload",icon:Nn,tone:"primary",onClick:l})})]})]})})}function bi(t){const{isSelected:e,pane:o,paneKey:s}=t,a=ae(o)&&o.type||null;return x(Le,{id:s,selected:e,children:[n(je,{title:"Unknown pane type"}),n(_e,{children:n(T,{padding:4,children:typeof a=="string"?x(R,{as:"p",muted:!0,children:["Structure item of type ",n("code",{children:a})," is not a known entity."]}):x(R,{as:"p",muted:!0,children:["Structure item is missing required ",n("code",{children:"type"})," property."]})})})]})}function vi(t){const e=[{ms:300,message:"Loading…"},{ms:5e3,message:"Still loading…"}],o=ee(null);return ds(...e.map(s=>{let{ms:a,message:c}=s;return o.pipe(us(c),ps(a))}))}const yi="Loading…",Pi=W(j)(Jt||(Jt=z([`
  opacity: 0;
  transition: opacity 200ms;

  &[data-mounted] {
    opacity: 1;
  }
`]))),Se=i.memo(t=>{const{delay:e=300,flex:o,message:s=vi,minWidth:a,paneKey:c,path:r,selected:l,title:d,tone:u}=t,h=i.useMemo(()=>typeof s=="function"?s(r?r.split(";"):[]):s,[s,r]),[p,g]=i.useState(()=>typeof h=="string"?h:yi);i.useEffect(()=>{if(typeof h!="object"||typeof h.subscribe=="function")return;const f=h.subscribe(g);return()=>f.unsubscribe()},[h]);const[m,v]=i.useState(null),[y,w]=i.useState(!1);return i.useEffect(()=>{if(m)return Qo(()=>w(!0))},[m]),n(Le,{flex:o,id:c,minWidth:a,selected:l,tone:u,children:n(_e,{children:x(Pi,{align:"center","data-mounted":y?"":void 0,direction:"column",height:"fill",justify:"center",ref:v,children:[n(Be,{muted:!0}),(d||p)&&n(T,{marginTop:3,children:n(R,{align:"center",muted:!0,size:1,children:d||p})})]})})})});Se.displayName="LoadingPane";const xi={component:i.lazy(()=>Me(()=>import("./index-a69607ad-4e77ecea.js"),["static/index-a69607ad-4e77ecea.js","static/sanity-dfa80759.js","static/index-25f114cf.js"])),document:i.lazy(()=>Me(()=>import("./index-ac94928b-c80d4c66.js"),["static/index-ac94928b-c80d4c66.js","static/sanity-dfa80759.js","static/index-25f114cf.js"])),documentList:i.lazy(()=>Me(()=>import("./index-e60b2e9d-abd777f5.js"),["static/index-e60b2e9d-abd777f5.js","static/sanity-dfa80759.js","static/PaneItem-a96ebe52-ab38a2b9.js","static/index-25f114cf.js"])),list:i.lazy(()=>Me(()=>import("./index-851f05dd-e04a9130.js"),["static/index-851f05dd-e04a9130.js","static/sanity-dfa80759.js","static/PaneItem-a96ebe52-ab38a2b9.js","static/index-25f114cf.js"]))},Si=i.memo(function(e){const{active:o,childItemId:s,groupIndex:a,index:c,itemId:r,pane:l,paneKey:d,params:u,payload:h,path:p,selected:g,siblingIndex:m}=e,v=xi[l.type]||bi;return n(Ys,{flatIndex:c,index:a,params:u,payload:h,siblingIndex:m,children:n(i.Suspense,{fallback:n(Se,{paneKey:d,path:p,selected:g}),children:n(v,{childItemId:s||"",index:c,itemId:r,isActive:o,isSelected:g,paneKey:d,pane:l})})})},(t,e)=>{let{params:o={},payload:s=null,...a}=t,{params:c={},payload:r=null,...l}=e;if(!nt(o,c)||!nt(s,r))return!1;const d=new Set([...Object.keys(a),...Object.keys(l)]);for(const u of d)if(a[u]!==l[u])return!1;return!0});function co(t){const{children:e,flex:o,minWidth:s,paneKey:a,title:c="Error",tone:r="critical"}=t;return x(Le,{flex:o,id:a,minWidth:s,tone:r,children:[n(je,{title:c}),n(_e,{overflow:"auto",children:n(T,{paddingX:4,paddingY:5,children:e})})]})}function _i(t){return t==="delete"?`An error occurred while attempting to delete this document.
      This usually means that there are other documents that refers to it.`:t==="unpublish"?`An error occurred while attempting to unpublish this document.
      This usually means that there are other documents that refers to it.`:"An error occurred during ".concat(t)}function wi(t){return t==="publish"?"The document was published":t==="unpublish"?"The document was unpublished. A draft has been created from the latest published version.":t==="discardChanges"?"All changes since last publish has now been discarded. The discarded draft can still be recovered from history":t==="delete"?"The document was successfully deleted":"Successfully performed ".concat(t," on document")}const Ci=["patch","commit"],Ii=i.memo(function(){const{push:e}=we(),{documentId:o,documentType:s}=V(),a=ea(o,s),c=i.useRef(a);return i.useEffect(()=>{!a||a===c.current||(a.type==="error"&&e({closable:!0,duration:3e4,status:"error",title:_i(a.op),description:x("details",{children:[n("summary",{children:"Details"}),a.error.message]})}),a.type==="success"&&!Ci.includes(a.op)&&e({closable:!0,status:"success",title:wi(a.op)}),c.current=a)},[a,e]),null}),Ei=t=>{const{features:e,hasValue:o,changesOpen:s}=t;return e.reviewChanges?{action:"reviewChanges",title:"Review changes",icon:hs,isDisabled:s||!o}:null},ki=t=>{let{hasValue:e}=t;return{action:"inspect",title:"Inspect",icon:ms,isDisabled:!e,shortcut:"Ctrl+Alt+I"}},Ti=t=>{let{previewUrl:e}=t;return e?{action:"production-preview",title:"Open preview",icon:fs,shortcut:"Ctrl+Alt+O"}:null},Mi=t=>[Ti,Ei,ki].filter(Boolean).map(o=>o(t)).filter(o=>o!==null),Di=t=>ae(t)&&typeof t._id=="string"&&typeof t._type=="string";function Ri(t){const[e,o]=i.useState(void 0),[s,a]=i.useState(null),{resolveProductionUrl:c}=Ae().document,r=Ks(t);if(s)throw s;return i.useEffect(()=>{r.pipe(Un(500),Ne(l=>Di(l)?to(c({document:l})):ee(void 0)),Wa(l=>{const d=ae(l)&&typeof l.message=="string"?l.message:"Unknown error";throw new Error("An error was thrown while trying to get your preview url: ".concat(d))})).subscribe({next:o,error:a})},[c,r]),e}function Oi(t,e){const o=e.panePayload||{},s=e.templateName;e.urlTemplate&&s&&s!==e.urlTemplate&&console.warn('Conflicting templates: URL says "'.concat(e.urlTemplate,'", structure node says "').concat(s,'". Using "').concat(s,'".'));const a=s||e.urlTemplate,c=t.filter(d=>d.schemaType===e.documentType),r={...e.templateParams,...typeof o=="object"?o||{}:{}};let l=a;return!a&&c.length===1&&(l=c[0].id),{templateName:l,templateParams:r}}const Li={},lo=i.memo(t=>{const{children:e,index:o,pane:s,paneKey:a}=t,c=jn(),r=zn(),{actions:l,badges:d,unstable_languageFilter:u}=Ae().document,h=ta(),p=Ce(),{features:g}=se(),{push:m}=we(),{options:v,menuItemGroups:y,title:w=null,views:b=[]}=s,f=le(v),P=f.id,S=ot(P),_=v.type,C=le(p.params),M=le(p.payload),{templateName:I,templateParams:E}=i.useMemo(()=>Oi(r,{documentType:_,templateName:f.template,templateParams:f.templateParameters,panePayload:M,urlTemplate:C==null?void 0:C.template}),[_,f,C,M,r]),O=na({documentId:S,documentType:_,templateName:I,templateParams:E}),D=le(O),{patch:B}=oa(S,_),L=aa(S,_),{validation:N}=sa(S,_),X=ia(S,_),K=c.get(_),A=(L==null?void 0:L.draft)||(L==null?void 0:L.published)||D.value,q=i.useMemo(()=>l({schemaType:_,documentId:S}),[l,S,_]),Z=i.useMemo(()=>d({schemaType:_,documentId:S}),[d,S,_]),Q=i.useMemo(()=>u({schemaType:_,documentId:S}),[S,_,u]),Ct=le(N),Fe=le(b),U=p.params||Li,[It,be]=i.useState(()=>U.path?Pe(U.path):[]),Po=U.view||Fe[0]&&Fe[0].id||null,[xo,So]=i.useState("closed"),ve=!!U.since,[Et,_o]=i.useState(null),ie=ra({documentId:S,documentType:_,onError:_o,rev:U.rev,since:U.since}),kt=H(ie,k=>k.onOlderRevision),Tt=H(ie,k=>k.revTime),wo=H(ie,k=>k.sinceAttributes),Mt=H(ie,k=>k.timelineDisplayed),Co=H(ie,k=>k.timelineReady),re=Ri(A),[Io,Eo]=i.useState([]);i.useEffect(()=>{const k=h.documentPresence(S).subscribe($=>{Eo($)});return()=>{k.unsubscribe()}},[S,h]);const Dt=Boolean(A),Ve=i.useMemo(()=>Mi({features:g,hasValue:Dt,changesOpen:ve,previewUrl:re}),[ve,g,Dt,re]),He=U.inspect==="on",Rt=ve?wo:(L==null?void 0:L.published)||null,Ue=X==="connected"&&L.ready&&(Co||!!Et),Ot=i.useMemo(()=>kt?Mt||{_id:A._id,_type:A._type}:A,[kt,Mt,A]),ko=i.useCallback((k,$)=>{p.setParams({...p.params,since:k,rev:$||void 0})},[p]),To=i.useCallback(k=>{be(k),h.setLocation([{type:"document",documentId:S,path:k,lastActiveAt:new Date().toISOString()}])},[S,h,be]),Mo=i.useCallback(k=>{be([])},[be]),Lt=i.useRef(()=>{throw new Error("Nope")});Lt.current=k=>{B.execute(ca(k.patches),D.value)};const Do=i.useCallback(k=>Lt.current(k),[]),Ro=i.useCallback(()=>{p.setParams({...U,since:void 0})},[p,U]),Ge=i.useCallback(()=>{p.setParams({...U,since:"@lastPublished"})},[p,U]),Oo=i.useCallback(()=>p.closeCurrent(),[p]),Lo=i.useCallback(()=>p.duplicateCurrent(),[p]),Te=i.useCallback(function(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!He)?p.setParams({...U,inspect:"on"}):p.setParams(ht(U,"inspect"))},[He,p,U]),Ke=i.useCallback(k=>k.action==="production-preview"&&re?(window.open(re),!0):k.action==="inspect"?(Te(!0),!0):k.action==="reviewChanges"?(Ge(),!0):!1,[Ge,re,Te]),Ao=i.useCallback(k=>{for(const $ of Ve)if($.shortcut&&mt($.shortcut,k)){k.preventDefault(),k.stopPropagation(),Ke($);return}},[Ke,Ve]),jo=i.useCallback(()=>Te(!1),[Te]),[zo,At]=i.useState([]),[Bo,jt]=i.useState(),[zt,Bt]=i.useState(),[Nt,Wt]=i.useState(),No=i.useCallback((k,$)=>{Bt(Y=>de(Y,k,$))},[]),Wo=i.useCallback((k,$)=>{Wt(Y=>de(Y,k,$))},[]),Fo=i.useCallback((k,$)=>jt(Y=>de(Y,k,$)),[]),Vo=A._createdAt?"update":"create",Ft=i.useMemo(()=>Boolean(K==null?void 0:K.liveEdit),[K==null?void 0:K.liveEdit]),$e=A._id?A._id:"dummy-id",Ho=i.useMemo(()=>({...A,_id:Ft?ot($e):la($e)}),[Ft,A,$e]),[ye,Xe]=da({document:Ho,permission:Vo}),Vt=!(A!=null&&A._id),Uo=i.useMemo(()=>{const k=!Xe&&!(ye!=null&&ye.granted),$=!Ht(K,"update"),Y=Vt&&!Ht(K,"create");return!Ue||Tt!==null||k||$||Y||X==="reconnecting"},[X,Vt,Xe,ye==null?void 0:ye.granted,Ue,Tt,K]),Ye=ua(K,{value:Ot,readOnly:Uo,comparisonValue:Rt,focusPath:It,openPath:zo,collapsedPaths:zt,presence:Io,validation:Ct,collapsedFieldSets:Nt,fieldGroupState:Bo,changesOpen:ve}),qe=i.useRef(Ye);qe.current=Ye;const Go=i.useCallback(k=>{pa(qe.current,k).forEach(Y=>{Y.type==="expandPath"&&Bt(ce=>de(ce,Y.path,!1)),Y.type==="expandFieldSet"&&Wt(ce=>de(ce,Y.path,!1)),Y.type==="setSelectedGroup"&&jt(ce=>de(ce,Y.path,Y.groupName))}),At(k)},[qe]),Ko={actions:q,activeViewId:Po,badges:Z,changesOpen:ve,collapsedFieldSets:Nt,collapsedPaths:zt,compareValue:Rt,connectionState:X,displayed:Ot,documentId:S,documentIdRaw:P,documentType:_,editState:L,focusPath:It,menuItems:Ve,onBlur:Mo,onChange:Do,onFocus:To,onPathOpen:Go,onHistoryClose:Ro,onHistoryOpen:Ge,onInspectClose:jo,onKeyUp:Ao,onMenuAction:Ke,onPaneClose:Oo,onPaneSplit:Lo,onSetActiveFieldGroup:Fo,onSetCollapsedPath:No,onSetCollapsedFieldSet:Wo,index:o,inspectOpen:He,validation:Ct,menuItemGroups:y||[],paneKey:a,previewUrl:re,ready:Ue,schemaType:K,isPermissionsLoading:Xe,permissions:ye,setTimelineMode:So,setTimelineRange:ko,timelineError:Et,timelineMode:xo,timelineStore:ie,title:w,value:A,views:Fe,formState:Ye,unstable_languageFilter:Q};return i.useEffect(()=>{X==="reconnecting"&&m({id:"sanity/desk/reconnecting",status:"warning",title:n(F,{children:"Connection lost. Reconnecting…"})})},[X,m]),i.useEffect(()=>{be(U.path?Pe(U.path):[]),At([])},[U.path,S]),n(ha.Provider,{value:Ko,children:e})});lo.displayName="DocumentPaneProvider";const Ai={create:"created",delete:"deleted",discardDraft:"discarded draft",initial:"created",editDraft:"edited",editLive:"live edited",publish:"published",unpublish:"unpublished"},ji={create:Xt,delete:Fs,discardDraft:xe,initial:Xt,editDraft:Yt,editLive:Yt,publish:Qn,unpublish:Vs};function uo(t){return Ai[t]}function zi(t){return ji[t]}function Bi(t){let{maxLength:e,userIds:o}=t;return n(Kn,{maxLength:e,children:o.map(s=>n($n,{user:s,withTooltip:!0},s))})}const Re=W(j)(t=>{let{theme:e}=t;var o;const s=(o=e.sanity.color.base.skeleton)==null?void 0:o.from;return oe(Zt||(Zt=z([`
    --timeline-hairline-width: 1px;
    position: relative;
    z-index: 2;
    margin: 0;
    padding: 0;

    &::before {
      position: absolute;
      content: '';
      height: 100%;
      width: var(--timeline-hairline-width);
      background: `,`;
      top: 0;
      left: calc((100% - var(--timeline-hairline-width)) / 2);
      z-index: 1;
    }
  `])),s)}),Ni=W(G)(t=>{let{$selected:e}=t;return oe(Qt||(Qt=z([`
    position: relative;
    width: 100%;

    /* Line styling */
    &[data-first] `,`::before {
      height: 50%;
      top: unset;
      bottom: 0;
    }

    &[data-last] `,`::before {
      height: 50%;
    }

    `,`
  `])),Re,Re,e&&oe(en||(en=z([`
      `,`::before {
        background: transparent;
      }
    `])),Re))}),Wi=W(T)(tn||(tn=z([`
  background: var(--card-bg-color);
  border-radius: 50px;
  position: relative;
  z-index: 2;
`]))),Fi=W(R)(nn||(nn=z([`
  text-transform: capitalize;
`]))),Vi=W(T)(on||(on=z([`
  min-width: 1rem;
  margin-left: `,`;
`])),t=>{let{theme:e}=t;return"-".concat(ue(e.sanity.space[1]))}),En={initial:"primary",create:"primary",publish:"positive",editLive:"caution",editDraft:"caution",unpublish:"critical",discardDraft:"critical",delete:"critical",withinSelection:"primary"};function Hi(t){let{chunk:e,isFirst:o,isLast:s,isLatest:a,isSelected:c,onSelect:r,timestamp:l,type:d}=t;const u=zi(d),h=Array.from(e.authors),p=i.useMemo(()=>{const m=new Date(l);return Gn(m,"MMM d, yyyy, hh:mm a")},[l]),g=i.useCallback(m=>{m.preventDefault(),m.stopPropagation(),r(e)},[r,e]);return n(Ni,{$selected:c,"data-chunk-id":e.id,"data-first":o?!0:void 0,"data-last":s?!0:void 0,"data-ui":"timelineItem",mode:c?"default":"bleed",onClick:g,padding:0,radius:2,tone:c?"primary":En[e.type],children:n(T,{paddingX:2,children:x(j,{align:"stretch",children:[n(Re,{align:"center",children:n(Wi,{padding:2,children:n(R,{size:2,children:u&&i.createElement(u)})})}),x(J,{space:2,margin:2,children:[a&&n(j,{children:n(te,{padding:1,radius:2,shadow:1,tone:c?"primary":En[e.type],children:n(it,{muted:!0,size:0,children:"Latest"})})}),n(T,{children:n(Fi,{size:1,weight:"medium",children:uo(d)||n("code",{children:d})})}),n(Vi,{paddingX:1,children:n(R,{size:0,muted:!0,children:p})})]}),n(j,{flex:1,justify:"flex-end",align:"center",children:n(Bi,{maxLength:3,userIds:h})})]})})})}const Ui=W(J)(an||(an=z([`
  max-width: 200px;
`]))),Gi=W(j)(sn||(sn=z([`
  max-height: calc(100vh - 198px);
  min-width: 244px;
`]))),Ki=W(T)(t=>{let{$visible:e}=t;return oe(rn||(rn=z([`
    opacity: 0;
    pointer-events: none;

    `,`
  `])),e&&oe(cn||(cn=z([`
      opacity: 1;
      pointer-events: auto;
    `]))))}),dt=t=>{let{chunks:e,disabledBeforeFirstChunk:o,hasMoreChunks:s,lastChunk:a,onLoadMore:c,onSelect:r,firstChunk:l}=t;const[d,u]=i.useState(!1),h=i.useMemo(()=>e.filter(m=>o&&l?m.index<l.index:!0),[e,o,l]),p=i.useMemo(()=>a!=null&&a.id?h.findIndex(m=>m.id===a.id):-1,[a==null?void 0:a.id,h]),g=i.useCallback((m,v)=>{let{activeIndex:y}=v;const w=y===0,b=h&&y===h.length-1||!1;return x(T,{paddingBottom:b?1:0,paddingTop:w?1:0,paddingX:1,children:[n(Hi,{chunk:m,isFirst:w,isLast:b,isLatest:y===0&&!o,isSelected:y===p,onSelect:r,timestamp:m.endTimestamp,type:m.type}),y===h.length-1&&s&&n(j,{align:"center",justify:"center",padding:4,children:n(Be,{muted:!0})})]})},[o,h,s,r,p]);return i.useEffect(()=>u(!0),[]),x(Ki,{$visible:!p||d,"data-ui":"timeline",children:[h.length===0&&x(Ui,{padding:3,space:3,children:[n(R,{size:1,weight:"semibold",children:"No document history"}),n(R,{muted:!0,size:1,children:"When changing the content of the document, the document versions will appear in this menu."})]}),h.length>0&&n(Gi,{direction:"column",children:n(Ls,{activeItemDataAttr:"data-hovered",ariaLabel:"Document revisions",autoFocus:!0,initialIndex:p,initialScrollAlign:"center",itemHeight:40,items:h,onEndReached:c,onEndReachedIndexOffset:20,overscan:5,renderItem:g,wrapAround:!1})})]})};dt.displayName="Timeline";function $i(){return x(j,{align:"flex-start",gap:3,padding:4,children:[n(Qe,{tone:"critical",children:n(no,{})}),x(J,{space:4,children:[n(Qe,{size:1,tone:"critical",weight:"semibold",children:"An error occurred whilst retrieving document changes."}),n(Qe,{size:1,tone:"critical",children:"Document history transactions have not been affected."})]})]})}const Xi=W(ft)(ln||(ln=z([`
  overflow: hidden;
`])));function po(t){let{chunk:e,mode:o,placement:s}=t;const{setTimelineRange:a,setTimelineMode:c,timelineError:r,ready:l,timelineStore:d}=V(),[u,h]=i.useState(!1),[p,g]=i.useState(null),[m,v]=i.useState(null),y=we(),w=H(d,A=>A.chunks),b=H(d,A=>A.isLoading),f=H(d,A=>A.hasMoreChunks),P=H(d,A=>A.realRevChunk),S=H(d,A=>A.sinceTime),_=i.useCallback(()=>{c(o),h(!0)},[o,c]),C=i.useCallback(()=>{c("closed"),h(!1)},[c]),M=i.useCallback(()=>{u&&C()},[C,u]),I=i.useCallback(A=>{u&&(A.key==="Escape"||A.key==="Tab")&&(C(),p==null||p.focus())},[p,C,u]);yt(M,[p,m]),Pt(I);const E=i.useCallback(A=>{try{const[q,Z]=d.findRangeForRev(A);c("closed"),a(q,Z)}catch(q){y.push({closable:!0,description:q.message,status:"error",title:"Unable to load revision"})}},[c,a,d,y]),O=i.useCallback(A=>{try{const[q,Z]=d.findRangeForSince(A);c("closed"),a(q,Z)}catch(q){y.push({closable:!0,description:q.message,status:"error",title:"Unable to load revision"})}},[c,a,d,y]),D=i.useCallback(()=>{b||d.loadMore()},[b,d]),B=r?n($i,{}):x(F,{children:[o==="rev"&&n(dt,{chunks:w,firstChunk:P,hasMoreChunks:f,lastChunk:P,onLoadMore:D,onSelect:E}),o==="since"&&n(dt,{chunks:w,disabledBeforeFirstChunk:!0,firstChunk:P,hasMoreChunks:f,lastChunk:S,onLoadMore:D,onSelect:O})]}),L=Yi((e==null?void 0:e.endTimestamp)||""),N=e?"".concat(Fa(uo(e.type)),": ").concat(L):"Latest version",X=e?"Since: ".concat(L):"Since: unknown version";return n(Xi,{constrainSize:!0,content:u&&B,"data-ui":"versionMenu",open:u,placement:s,portal:!0,ref:v,children:n(G,{disabled:!l,mode:"bleed",fontSize:1,padding:2,iconRight:Va,onClick:u?C:_,ref:g,selected:u,text:l?o==="rev"?N:X:"Loading history"})})}function Yi(t){return i.useMemo(()=>{const o=t?new Date(t):new Date;return Gn(o,"MMM d, yyyy, hh:mm a")},[t])}function qi(){return n(so,{ms:300,children:x(j,{align:"center",direction:"column",height:"fill",justify:"center",paddingTop:3,children:[n(Be,{muted:!0}),n(T,{marginTop:3,children:n(R,{align:"center",muted:!0,size:1,children:"Loading changes"})})]})})}function Ji(t){const e=new Map;return gs(t,o=>{if(o.action==="unchanged"||!("annotation"in o)||!o.annotation)return!0;const{author:s,timestamp:a}=o.annotation,c=e.get(s);return(!c||c.timestamp<a)&&e.set(s,o.annotation),!0}),Array.from(e.values()).sort((o,s)=>o.timestamp<s.timestamp?1:-1)}const Zi=W(Bn)(dn||(dn=z([`
  height: 100%;
  overflow: auto;
  position: relative;
  scroll-behavior: smooth;
`])));function Qi(){const{documentId:t,onHistoryClose:e,schemaType:o,timelineError:s,timelineStore:a,value:c}=V(),{collapsed:r}=Ha(),l=i.useRef(null),d=H(a,w=>w.diff),u=H(a,w=>w.onOlderRevision),h=H(a,w=>w.selectionState),p=H(a,w=>w.sinceTime),g=h==="loading",m=!u,v=fe.useMemo(()=>({documentId:t,schemaType:o,FieldWrapper:Ua,rootDiff:d,isComparingCurrent:m,value:c}),[t,d,m,o,c]),y=fe.useMemo(()=>d?Ji(d):[],[d]);return r?null:x(j,{direction:"column",flex:1,style:{borderLeft:"1px dashed var(--card-border-color)",overflow:"hidden",minWidth:320},"data-testid":"review-changes-pane",children:[n(je,{actions:n(G,{icon:xe,mode:"bleed",onClick:e,padding:3,title:"Hide changes panel"}),subActions:y.length>0&&n(T,{paddingRight:1,children:n(Ga,{annotations:y,description:"Changes by",placement:"bottom-end",children:n(Kn,{maxLength:4,children:y.map(w=>{let{author:b}=w;return n($n,{user:b},b)})})})}),tabs:n(po,{mode:"since",chunk:p,placement:"bottom-start"}),title:"Changes"}),n(_e,{children:n(vt,{element:l.current,children:n(Zi,{"data-ui":"Scroller",ref:l,children:n(T,{flex:1,padding:4,children:n(er,{diff:d,documentContext:v,error:s,loading:g})})})})})]})}function er(t){let{error:e,diff:o,documentContext:s,loading:a}=t;const{schemaType:c}=V();return e?n(Gt,{}):a?n(qi,{}):o?n(Ka.Provider,{value:s,children:n($a,{diff:o,schemaType:c})}):n(Gt,{})}function tr(t,e,o){const s=ma(),[a,c]=i.useState(o),r=i.useMemo(()=>s.forNamespace("desk-tool"),[s]),l=i.useMemo(()=>t?r.forNamespace(t).forKey(e):r.forKey(e),[r,t,e]);i.useEffect(()=>{const u=l.listen(o).subscribe({next:c});return()=>u==null?void 0:u.unsubscribe()},[o,e,t,l]);const d=i.useCallback(u=>{c(u),l.set(u)},[l]);return i.useMemo(()=>[a,d],[d,a])}const pe={id:"parsed",title:"Parsed"},he={id:"raw",title:"Raw JSON"},nr=[pe,he],Oe=Hs(1e3);function ho(t,e){const o=Oe.get(t);return o===void 0?(Oe.set(t,Array.isArray(e)||ae(e)),ho(t,e)):o}function or(t){const{path:e}=t,o=Oe.get(e);o!==void 0&&Oe.set(e,!o)}function mo(t){const e=window.getSelection();if(e){const o=document.createRange();e.removeAllRanges(),o.selectNodeContents(t),e.addRange(o)}}function kn(t){mo(t.currentTarget)}function ar(t){t.keyCode===65&&(t.metaKey||t.ctrlKey)&&(t.preventDefault(),mo(t.currentTarget))}function sr(t){return ae(t)&&$t(t._id)&&$t(t._type)}const ir=W.div(t=>{let{theme:e}=t;const{color:o,fonts:s,space:a}=e.sanity;return oe(un||(un=z([`
    & .json-inspector,
    & .json-inspector .json-inspector__selection {
      font-family: `,`;
      font-size: `,`px;
      line-height: `,`px;
      color: var(--card-code-fg-color);
    }

    & .json-inspector .json-inspector__leaf {
      padding-left: `,`;
    }

    & .json-inspector .json-inspector__leaf.json-inspector__leaf_root {
      padding-top: `,`;
      padding-left: 0;
    }

    & .json-inspector > .json-inspector__leaf_root > .json-inspector__line > .json-inspector__key {
      display: none;
    }

    & .json-inspector .json-inspector__line {
      display: block;
      position: relative;
      cursor: default;
    }

    & .json-inspector .json-inspector__line::after {
      content: '';
      position: absolute;
      top: 0;
      left: -200px;
      right: -50px;
      bottom: 0;
      z-index: -1;
      pointer-events: none;
    }

    & .json-inspector .json-inspector__line:hover::after {
      background: var(--card-code-bg-color);
    }

    & .json-inspector .json-inspector__leaf_composite > .json-inspector__line {
      cursor: pointer;
    }

    & .json-inspector .json-inspector__leaf_composite > .json-inspector__line::before {
      content: '▸ ';
      margin-left: calc(0 - `,` + 3px);
      font-size: `,`px;
      line-height: `,`px;
    }

    &
      .json-inspector
      .json-inspector__leaf_expanded.json-inspector__leaf_composite
      > .json-inspector__line::before {
      content: '▾ ';
      font-size: `,`px;
      line-height: `,`px;
    }

    & .json-inspector .json-inspector__radio,
    & .json-inspector .json-inspector__flatpath {
      display: none;
    }

    & .json-inspector .json-inspector__value {
      margin-left: `,`;
    }

    &
      .json-inspector
      > .json-inspector__leaf_root
      > .json-inspector__line
      > .json-inspector__key
      + .json-inspector__value {
      margin: 0;
    }

    & .json-inspector .json-inspector__key {
      color: `,`;
    }

    & .json-inspector .json-inspector__value_helper,
    & .json-inspector .json-inspector__value_null {
      color: `,`;
    }

    & .json-inspector .json-inspector__not-found {
      padding-top: `,`;
    }

    & .json-inspector .json-inspector__value_string {
      color: `,`;
    }

    & .json-inspector .json-inspector__value_boolean {
      color: `,`;
    }

    & .json-inspector .json-inspector__value_number {
      color: `,`;
    }

    & .json-inspector .json-inspector__show-original {
      display: inline-block;
      padding: 0 6px;
      cursor: pointer;
    }

    & .json-inspector .json-inspector__show-original:hover {
      color: inherit;
    }

    & .json-inspector .json-inspector__show-original::before {
      content: '↔';
    }

    & .json-inspector .json-inspector__show-original:hover::after {
      content: ' expand';
    }
  `])),s.code.family,s.code.sizes[2].fontSize,s.code.sizes[2].lineHeight,ue(a[4]),ue(a[3]),ue(a[4]),s.code.sizes[2].fontSize,s.code.sizes[2].lineHeight,s.code.sizes[2].fontSize,s.code.sizes[2].lineHeight,ue(a[4]/2),o.syntax.property,o.syntax.constant,ue(a[3]),o.syntax.string,o.syntax.boolean,o.syntax.number)});function rr(t){const{onChange:e,query:o}=t,s=i.useCallback(a=>e(a.target.value),[e]);return n(As,{icon:js,onChange:s,placeholder:"Search",radius:2,value:o||""})}function cr(t){const{value:e}=t,{onInspectClose:o,paneKey:s}=V(),a="".concat(s,"_inspect_"),[c,r]=tr("desk-tool","inspect-view-preferred-view-mode-".concat(s),"parsed"),l=nr.find(h=>h.id===c),d=i.useCallback(()=>{r(pe.id)},[r]),u=i.useCallback(()=>{r(he.id)},[r]);return n(St,{id:"".concat(a,"dialog"),header:sr(e)?x(F,{children:["Inspecting"," ",n("em",{children:n(bs,{document:e})})]}):n("em",{children:"No value"}),onClose:o,onClickOutside:o,width:3,children:x(j,{direction:"column",height:"fill",children:[n(te,{padding:3,shadow:1,style:{position:"sticky",bottom:0,zIndex:3},children:x(Yn,{space:1,children:[n(st,{"aria-controls":"".concat(a,"tabpanel"),fontSize:1,id:"".concat(a,"tab-").concat(pe.id),label:pe.title,onClick:d,selected:l===pe}),n(st,{"aria-controls":"".concat(a,"tabpanel"),fontSize:1,id:"".concat(a,"tab-").concat(he.id),label:he.title,onClick:u,selected:l===he})]})}),x(vs,{"aria-labelledby":"".concat(a,"tab-").concat(c),flex:1,id:"".concat(a,"tabpanel"),overflow:"auto",padding:4,style:{outline:"none"},children:[l===pe&&n(ir,{children:n(Us,{data:e,isExpanded:ho,onClick:or,search:rr})}),l===he&&n(rt,{language:"json",tabIndex:0,onKeyDown:ar,onDoubleClick:kn,onFocus:kn,children:JSON.stringify(e,null,2)})]})]})})}const lr=W(te)(pn||(pn=z([`
  position: relative;
  z-index: 50;
`]))),Tn=W(R)(hn||(hn=z([`
  & > * {
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
  }
`]))),fo=i.memo(()=>{var t,e,o,s,a,c;const r=fa(),{params:l,groupIndex:d,routerPanesState:u,replaceCurrent:h,BackLink:p}=Ce(),g=(t=u[d])==null?void 0:t[0].id,m=u[d-1],v=m==null?void 0:m[0],y=v==null?void 0:v.id,w=Boolean((e=v==null?void 0:v.params)==null?void 0:e.rev),b=i.useMemo(()=>(l==null?void 0:l.parentRefPath)&&Pe(l.parentRefPath)||null,[l==null?void 0:l.parentRefPath]),f=ga(()=>{const _=b==null?void 0:b[0];if(!y||!_||!b)return ee({loading:!1});const C=ot(y),M=Pe(_),I=M.findIndex(E=>typeof E=="object"&&"_key"in E);return Xn(ee({loading:!0}),r.unstable_observePathsDocumentPair(C,I===-1?M:M.slice(0,I)).pipe(Un(750),ne(E=>{let{draft:O,published:D}=E;var B;return{loading:!1,result:{availability:{draft:O.availability,published:D.availability},refValue:(B=Xa(O.snapshot||D.snapshot,b))==null?void 0:B._ref}}})))},[r,y,b],{loading:!0}),P=i.useCallback(()=>{var _;f.loading||(_=f.result)!=null&&_.refValue&&h({id:f.result.refValue,params:l})},[f.loading,f.result,h,l]);return!y||!b||w||f.loading||!((o=f.result)!=null&&o.availability.draft.available)&&!((s=f.result)!=null&&s.availability.published.available)||((a=f.result)==null?void 0:a.refValue)===g?null:n(lr,{shadow:1,tone:"caution","data-testid":"reference-changed-banner",children:n(Ie,{paddingX:4,paddingY:2,sizing:"border",width:1,children:x(j,{align:"center",children:[n(R,{size:1,children:n(gt,{})}),(c=f.result)!=null&&c.refValue?x(F,{children:[n(T,{flex:1,marginLeft:3,children:n(Tn,{title:"This reference has changed since you opened it.",size:1,children:"This reference has changed since you opened it."})}),n(T,{marginLeft:3,children:n(G,{onClick:P,icon:Nn,fontSize:1,mode:"ghost",padding:2,space:2,text:"Reload reference"})})]}):x(F,{children:[n(T,{flex:1,marginLeft:3,children:n(Tn,{title:"This reference has been removed since you opened it.",size:1,children:"This reference has been removed since you opened it."})}),n(T,{marginLeft:3,children:n(G,{as:p,icon:xe,fontSize:1,mode:"ghost",padding:2,space:2,text:"Close reference"})})]})]})})})});fo.displayName="ReferenceChangedBanner";const dr=W(te)(mn||(mn=z([`
  position: relative;
  z-index: 50;
`])));function ur(t){let{granted:e,requiredPermission:o}=t;var s,a;const c=ys(),r=((s=c==null?void 0:c.roles)==null?void 0:s.length)!==1,l=pr(((a=c==null?void 0:c.roles)==null?void 0:a.map(d=>n("code",{children:d.title},d.name)))||[],", ");return e?null:n(dr,{"data-testid":"permission-check-banner",shadow:1,tone:"transparent",children:n(Ie,{paddingX:4,paddingY:3,sizing:"border",width:1,children:x(j,{align:"flex-start",children:[n(R,{size:1,children:n(Ps,{})}),n(T,{flex:1,marginLeft:3,children:x(R,{size:1,children:["Your role",r&&"s"," ",l," ",r?"do":"does"," not have permissions to"," ",o," this document."]})})]})})})}function pr(t,e){return t.reduce((o,s)=>o===null?[s]:o.concat([e,s]),null)}function hr(t){const e=i.useRef();return i.useEffect(()=>{e.current=t},[t]),e.current}const mr=1e3*60*60*24*24;function fr(t){const e=we(),o=hr(t.enabled);i.useEffect(()=>{!o&&t.enabled&&e.push({...t,duration:mr}),o&&!t.enabled&&e.push({...t,duration:.01})},[t,e,o])}const gr=t=>t.preventDefault();function br(t){var e;const{hidden:o,margins:s}=t,{collapsedFieldSets:a,collapsedPaths:c,displayed:r,editState:l,documentId:d,documentType:u,onChange:h,validation:p,ready:g,formState:m,onFocus:v,onBlur:y,onSetCollapsedPath:w,onPathOpen:b,onSetCollapsedFieldSet:f,onSetActiveFieldGroup:P}=V(),S=An(),_=xs(d),C=i.useMemo(()=>Ss(),[]),M=(e=l==null?void 0:l.transactionSyncLock)==null?void 0:e.enabled;fr({id:"sync-lock-".concat(d),status:"warning",enabled:M,title:"Syncing document…",description:"Please hold tight while the document is synced. This usually happens right after the document has been published, and it shouldn't take more than a few seconds"}),i.useEffect(()=>{const O=S.pair.documentEvents(d,u).pipe(_s(D=>{D.type==="mutation"&&C.publish(vr(D)),D.type==="rebase"&&C.publish(yr(D))})).subscribe();return()=>{O.unsubscribe()}},[d,S,u,C]);const I=Boolean(r==null?void 0:r._rev);i.useEffect(()=>{I&&C.publish({type:"mutation",patches:[],snapshot:r})},[I]);const E=i.useRef(null);return i.useEffect(()=>{ws(E.current)},[]),n(Ie,{hidden:o,paddingX:4,paddingTop:5,paddingBottom:9,sizing:"border",width:1,children:n(Cs,{margins:s,children:n(T,{as:"form",onSubmit:gr,ref:E,children:g?m===null?n(T,{padding:2,children:n(R,{children:"This form is hidden"})}):n(Is,{__internal_patchChannel:C,collapsedFieldSets:a,collapsedPaths:c,focusPath:m.focusPath,changed:m.changed,focused:m.focused,groups:m.groups,id:"root",members:m.members,onChange:h,onFieldGroupSelect:P,onPathBlur:y,onPathFocus:v,onPathOpen:b,onSetFieldSetCollapsed:f,onSetPathCollapsed:w,presence:_,readOnly:m.readOnly,schemaType:m.schemaType,validation:p,value:m.value}):n(so,{ms:300,children:x(j,{align:"center",direction:"column",height:"fill",justify:"center",children:[n(Be,{muted:!0}),n(T,{marginTop:3,children:n(R,{align:"center",muted:!0,size:1,children:"Loading document"})})]})})})})})}function vr(t){const e=t.mutations.map(o=>o.patch).filter(Boolean);return{type:"mutation",snapshot:t.document,patches:ct(t.origin,e)}}function yr(t){const e=t.remoteMutations.map(s=>s.patch).filter(Boolean),o=t.localMutations.map(s=>s.patch).filter(Boolean);return{type:"rebase",snapshot:t.document,patches:ct("remote",e).concat(ct("local",o))}}function Pr(){const{activeViewId:t,paneKey:e,views:o}=V(),s="".concat(e,"tabpanel");return n(Yn,{space:1,children:o.map((a,c)=>{var r;return n(xr,{icon:a.icon,id:"".concat(e,"tab-").concat(a.id),isActive:t===a.id,label:n(F,{children:a.title}),tabPanelId:s,viewId:c===0?null:(r=a.id)!=null?r:null},a.id)})})}function xr(t){const{icon:e,id:o,isActive:s,label:a,tabPanelId:c,viewId:r}=t,{ready:l}=V(),{setView:d}=Ce(),u=i.useCallback(()=>d(r),[d,r]);return n(st,{"aria-controls":c,disabled:!l,fontSize:1,icon:e,id:o,selected:s,label:a,onClick:u})}const tt={error:{tone:"critical",icon:no},warning:{tone:"caution",icon:gt},info:{tone:"primary",icon:Es}};function Sr(t){const{boundaryElement:e,isOpen:o,setOpen:s}=t,{onFocus:a,onPathOpen:c,schemaType:r,validation:l}=V(),d=i.useId(),u=l.length>0,h=l.some(Ya),p=l.some(qa),g=l.some(Ja),m=i.useMemo(()=>{if(h)return tt.error;if(p)return tt.warning;if(g)return tt.info},[h,g,p]),v=i.useCallback(w=>{c(w),a(w)},[a,c]),y=i.useCallback(()=>s(!1),[s]);return u?n(qn,{id:d||"",button:n(G,{...m,title:"Show validation issues",mode:"bleed","data-testid":"validation-list-button"}),menu:n(Jn,{open:o,children:n(Za,{documentType:r,validation:l,onClose:y,onFocus:v})}),popover:{portal:!0,boundaryElement:e,constrainSize:!0,preventOverflow:!0,width:0},placement:"bottom"}):null}function _r(){const{connectionState:t,schemaType:e,title:o,value:s}=V(),a=Boolean(s)&&t==="connected",{error:c,value:r}=Qa({enabled:a,schemaType:e,value:s});return t!=="connected"?n(F,{}):o?n(F,{children:o}):s?c?x(F,{children:["Error: ",c.message]}):n(F,{children:(r==null?void 0:r.title)||n("span",{style:{color:"var(--card-muted-fg-color)"},children:"Untitled"})}):x(F,{children:["New ",(e==null?void 0:e.title)||(e==null?void 0:e.name)]})}const wr=t=>Boolean(t.showAsAction),Cr=ba(wr),go=i.memo(i.forwardRef((t,e)=>{let{rootElement:o}=t;const{onMenuAction:s,onPaneClose:a,onPaneSplit:c,validation:r,menuItems:l,menuItemGroups:d,schemaType:u,timelineStore:h,ready:p,views:g,unstable_languageFilter:m}=V(),{features:v}=se(),{index:y,BackLink:w,hasGroupSiblings:b}=Ce(),f=i.useMemo(()=>l.filter(Cr),[l]),[P,S]=fe.useState(!1),_=g.length>1,C=v.reviewChanges,M=H(h,D=>D.revTime),I=v.splitViews&&c&&g.length>1,E=I&&b,O=!E&&!v.backButton;return n(je,{ref:e,loading:!p,title:n(_r,{}),tabs:_&&n(Pr,{}),backButton:v.backButton&&y>0&&n(G,{as:w,"data-as":"a",icon:va,mode:"bleed"}),subActions:C&&n(po,{chunk:M,mode:"rev",placement:"bottom-end"}),actions:x(Wn,{space:1,children:[m.length>0&&n(F,{children:m.map((D,B)=>i.createElement(D,{key:"language-filter-".concat(B),schemaType:u}))}),r.length>0&&n(Sr,{boundaryElement:o,isOpen:P,setOpen:S},"validation-menu"),n(ya,{itemGroups:d,items:f,onAction:s},"context-menu"),I&&n(G,{icon:Pa,mode:"bleed",onClick:c,title:"Split pane right"},"split-pane-button"),E&&n(G,{icon:xe,mode:"bleed",onClick:a,title:"Close split pane"},"close-view-button"),O&&n(G,{icon:xe,mode:"bleed",title:"Close pane group",as:w},"close-view-button")]})})}));go.displayName="DocumentPanelHeader";const Ir=W(Bn)(t=>{let{$disabled:e}=t;return e?{height:"100%"}:oe(fn||(fn=z([`
    height: 100%;
    overflow: auto;
    position: relative;
    scroll-behavior: smooth;
    outline: none;
  `])))}),Er=function(e){const{footerHeight:o,isInspectOpen:s,rootElement:a,setDocumentPanelPortalElement:c}=e,{activeViewId:r,displayed:l,documentId:d,editState:u,value:h,views:p,ready:g,schemaType:m,permissions:v,isPermissionsLoading:y}=V(),{collapsed:w}=Vn(),b=es(),{features:f}=se(),[P,S]=i.useState(null),_=ze(P),C=i.useRef(null),[M,I]=i.useState(null),E=h._createdAt?"update":"create",O=i.useMemo(()=>p.find(K=>K.id===r)||p[0]||{type:"form"},[r,p]),D=f.splitPanes&&C.current||b.element,B=i.useMemo(()=>w?[(_==null?void 0:_.height)||0,0,o?o+2:2,0]:[0,0,2,0],[w,o,_]),L=O.type!=="form",N=i.useMemo(()=>O.type==="component"&&O.component&&i.createElement(O.component,{document:{draft:(u==null?void 0:u.draft)||null,displayed:l||h,historical:l,published:(u==null?void 0:u.published)||null},documentId:d,options:O.options,schemaType:m}),[O,l,d,u==null?void 0:u.draft,u==null?void 0:u.published,m,h]);i.useEffect(()=>{M!=null&&M.scrollTo&&M.scrollTo(0,0)},[d,M]),i.useEffect(()=>{D&&c(D)},[D,c]);const X=i.useMemo(()=>s?n(cr,{value:l||h}):null,[s,l,h]);return x(j,{direction:"column",flex:2,overflow:w?void 0:"hidden",children:[n(go,{rootElement:a,ref:S}),n(_e,{children:n(bt,{element:D,__unstable_elements:{documentScrollElement:M},children:x(vt,{element:M,children:[O.type==="form"&&!y&&g&&x(F,{children:[n(ur,{granted:Boolean(v==null?void 0:v.granted),requiredPermission:E}),n(fo,{})]}),x(Ir,{$disabled:w||!1,"data-testid":"document-panel-scroller",ref:I,children:[n(br,{hidden:L,margins:B},d+(g?"_ready":"_pending")),N]}),X,n("div",{"data-testid":"document-panel-portal",ref:C})]})})})]})},bo=["left","bottom"],kr={small:0,medium:1,large:2,full:"auto"};function Tr(t){const{dialog:e,referenceElement:o}=t;return n(ft,{content:n(Mr,{dialog:e}),fallbackPlacements:bo,open:!0,placement:"top",portal:!0,preventOverflow:!0,referenceElement:o})}function Mr(t){const{dialog:e}=t,{cancelButtonIcon:o,cancelButtonText:s,confirmButtonIcon:a,confirmButtonText:c,message:r,onCancel:l,onConfirm:d,tone:u}=e,{isTopLayer:h}=oo(),[p,g]=i.useState(null),m=i.useCallback(()=>{h&&l()},[h,l]),v=i.useCallback(y=>{y.key==="Escape"&&h&&l()},[h,l]);return yt(m,[p]),Pt(v),x(j,{direction:"column",ref:g,style:{minWidth:320-16,maxWidth:400},children:[n(T,{flex:1,overflow:"auto",padding:4,children:n(R,{children:r})}),n(T,{paddingX:4,paddingY:3,style:{borderTop:"1px solid var(--card-border-color)"},children:x(zs,{columns:2,gap:2,children:[n(G,{icon:o,onClick:l,mode:"ghost",text:s||"Cancel"}),n(G,{icon:a,onClick:d,text:c||"Confirm",tone:u})]})})]})}function Dr(t){const{dialog:e}=t,o=i.useId(),s=e.footer&&n(T,{paddingX:4,paddingY:3,children:e.footer});return n(xt,{zOffset:"fullscreen",children:n(St,{__unstable_hideCloseButton:e.showCloseButton===!1,footer:s,header:e.header,id:o,onClose:e.onClose,onClickOutside:e.onClose,width:e.width===void 0?1:kr[e.width],portal:"documentPanelPortalElement",children:n(T,{padding:4,children:e.content})})})}function Rr(t){const{dialog:e,referenceElement:o}=t;return n(ft,{content:n(Or,{dialog:e}),fallbackPlacements:bo,open:!0,placement:"top",portal:!0,preventOverflow:!0,referenceElement:o})}function Or(t){const{dialog:e}=t,{content:o,onClose:s}=e,{isTopLayer:a}=oo(),[c,r]=i.useState(null),l=i.useCallback(()=>{a&&s()},[a,s]),d=i.useCallback(u=>{u.key==="Escape"&&a&&s()},[a,s]);return yt(l,[c]),Pt(d),n("div",{ref:r,children:o})}function wt(t){const{dialog:e,referenceElement:o=null}=t,s=i.useId();if(e.type==="confirm")return n(Tr,{dialog:e,referenceElement:o});if(e.type==="popover")return n(Rr,{dialog:e,referenceElement:o});if(e.type==="dialog"||!e.type)return n(Dr,{dialog:e});const a=e;return console.warn("Unsupported modal type ".concat(a.type)),n(St,{id:s,onClose:a.onClose,onClickOutside:a.onClose,width:2,children:n(T,{padding:4,children:a.content||x(F,{children:["Unexpected modal type (",n("code",{children:a.type}),")"]})})})}function Lr(t){const{actionStates:e,disabled:o}=t,s=i.useId(),a=i.useRef(null),[c,r]=i.useState(-1),[l,d]=i.useState(null),u=i.useCallback(g=>{r(g)},[]),h=i.useMemo(()=>({placement:"top-end",portal:!0,preventOverflow:!0}),[]),p=e[c];return x(F,{children:[n(qn,{id:"".concat(s,"-action-menu"),button:n(G,{"data-testid":"action-menu-button","aria-label":"Open document actions",disabled:o,icon:ks,mode:"ghost",ref:a}),menu:n(Jn,{padding:1,children:e.map((g,m)=>n(Ar,{actionState:g,disabled:o,index:m,onAction:u},m))}),popover:h,ref:d}),p&&p.dialog&&n(xt,{zOffset:"paneFooter",children:n(wt,{dialog:p.dialog,referenceElement:l})})]})}function Ar(t){const{actionState:e,disabled:o,index:s,onAction:a}=t,{onHandle:c}=e,r=i.useCallback(()=>{a(s),c&&c()},[s,a,c]),l=e.title&&n(T,{padding:2,children:n(R,{size:1,children:e.title})});return n(Ts,{"data-testid":"action-".concat(e.label.replace(" ","")),disabled:o||Boolean(e.disabled),onClick:r,padding:0,tone:e.tone,children:n(ke,{content:l,disabled:!l,fallbackPlacements:["left","bottom"],placement:"top",portal:!0,children:x(j,{align:"center",paddingX:3,children:[x(j,{flex:1,paddingY:3,children:[e.icon&&n(T,{marginRight:3,children:x(R,{children:[i.isValidElement(e.icon)&&e.icon,Ms.isValidElementType(e.icon)&&i.createElement(e.icon)]})}),n(R,{children:e.label})]}),e.shortcut&&n(T,{marginLeft:3,children:n(Zn,{keys:String(e.shortcut).split("+").map(d=>d.slice(0,1).toUpperCase()+d.slice(1))})})]})})})}function vo(t){const{disabled:e,showMenu:o,states:s}=t,[a,...c]=s,[r,l]=i.useState(null),d=i.useMemo(()=>!a||!a.title&&!a.shortcut?null:x(j,{padding:2,style:{maxWidth:300},align:"center",children:[n(R,{size:1,children:a.title}),a.shortcut&&n(T,{marginLeft:a.title?2:0,children:n(Zn,{keys:String(a.shortcut).split("+").map(u=>u.slice(0,1).toUpperCase()+u.slice(1).toLowerCase())})})]}),[a]);return x(j,{children:[a&&n(ts,{zOffset:200,children:n(ke,{disabled:!d,content:d,portal:!0,placement:"top",children:n(J,{flex:1,children:n(G,{"data-testid":"action-".concat(a.label),disabled:e||Boolean(a.disabled),icon:a.icon,onClick:a.onHandle,ref:l,text:a.label,tone:a.tone||"primary"})})})}),o&&c.length>0&&n(T,{marginLeft:1,children:n(Lr,{actionStates:c,disabled:e})}),a&&a.dialog&&n(wt,{dialog:a.dialog,referenceElement:r})]})}const jr=i.memo(function(){const{actions:e,connectionState:o,documentId:s,editState:a}=V();return!e||!a?null:n(_t,{actions:e,actionProps:a,children:c=>{let{states:r}=c;return n(vo,{disabled:o!=="connected",showMenu:e.length>1,states:r},s)}})}),zr=i.memo(function(){const{connectionState:e,editState:o,timelineStore:s}=V(),a=H(s,u=>u.revTime),c=(a==null?void 0:a.id)||"",r=((o==null?void 0:o.draft)||(o==null?void 0:o.published)||{})._rev===c,l=i.useMemo(()=>({...o||{},revision:c}),[o,c]),d=i.useMemo(()=>[xa],[]);return n(_t,{actions:d,actionProps:l,children:u=>{let{states:h}=u;return n(vo,{disabled:e!=="connected"||Boolean(r),showMenu:!1,states:h})}})}),Br={primary:"primary",success:"positive",warning:"caution",danger:"critical"};function Nr(t){let{states:e}=t;return n(Wn,{space:1,children:e.map((o,s)=>n(ke,{content:o.title&&n(T,{padding:2,children:n(R,{size:1,children:o.title})}),disabled:!o.title,placement:"top",portal:!0,children:n(Ds,{fontSize:1,mode:"outline",paddingX:2,paddingY:1,radius:4,tone:o.color?Br[o.color]:void 0,style:{whiteSpace:"nowrap"},children:o.label})},String(s)))})}function Wr(){const{badges:t,editState:e}=V();return!e||!t?null:n($s,{badges:t,badgeProps:e,children:o=>{let{states:s}=o;return n(Nr,{states:s})}})}const Fr=W(j)(gn||(gn=z([`
  cursor: default;
`])));function Vr(t){const{collapsed:e,disabled:o,lastPublished:s,lastUpdated:a,liveEdit:c}=t,r=me(s||"",{minimal:!0,agoSuffix:!0}),l=me(s||"",{minimal:!0}),d=me(a||"",{minimal:!0,agoSuffix:!0}),u=me(a||"",{minimal:!0});return n(Fr,{align:"center","data-ui":"SessionLayout",sizing:"border",children:n(ke,{placement:"top",portal:!0,content:n(J,{padding:3,space:3,children:n(R,{size:1,muted:!0,children:c?x(F,{children:["Last updated ",a?d:r]}):x(F,{children:["Last published ",r]})})}),children:n(G,{mode:"bleed",tone:c?"critical":"positive",tabIndex:-1,disabled:o,children:x(j,{align:"center",children:[n(T,{marginRight:e?0:3,children:n(R,{size:2,children:c?n(ns,{}):n(Qn,{})})}),!e&&n(R,{size:1,weight:"medium",children:c?n(F,{children:a?u:l}):l})]})})})})}const Hr=W(Ee.path)(bn||(bn=z([`
  transform-origin: center;
`]))),Ur=t=>n(Ee.circle,{fill:"none",r:"8",cx:"12.5",cy:"12.5",strokeWidth:"1.2",...t}),Gr=t=>n(Hr,{fill:"none",d:"M14 17.5619L11.5 20.5L14.5 23.0619M11 7.43811L13.5 4.50001L10.5 1.93811",...t}),Kr=t=>n(Ee.path,{d:"M9.5 12.1316L11.7414 14.5L16 10",...t}),$r=t=>n(Ee.path,{d:"M15 7L18 10M6 19L7 15L17 5L20 8L10 18L6 19Z",...t}),Xr=Sa(vn||(vn=z([`
  0% {
    transform: rotate(0);
  }
  100% {
    transform: rotate(360deg);
  }
`]))),Yr=W.g(yn||(yn=z([`
  transform-origin: center;

  &[data-rotate] {
    animation: `,` 1s ease-in-out infinite;
  }
`])),Xr),qr={syncing:{scale:1,transition:{duration:0}},saved:{scale:[1,.8,1.2,.9,1.1,.95,1.05,.99,1],transition:{duration:.5,delay:.2}},changes:{transition:{duration:0}}},Jr={syncing:{strokeDasharray:"0, 0, 23, 3, 23, 3",strokeDashoffset:10,opacity:1,transition:{duration:0}},saved:{strokeDasharray:"0, 0, 23, 0, 23, 0",strokeDashoffset:10,opacity:1,transition:{duration:.2}},changes:{strokeDasharray:"0, 60, 23, 0, 23, 0",strokeDashoffset:0,opacity:0,transition:{duration:.5}}},Zr={syncing:{opacity:1,transition:{duration:0}},saved:{opacity:0,transition:{duration:.2}},changes:{opacity:0}},Qr={syncing:{pathLength:0,transition:{duration:0}},saved:{pathLength:1,transition:{delay:.4,duration:.3}},changes:{pathLength:0,transition:{duration:.2}}},ec={syncing:{pathLength:0,transition:{duration:0}},saved:{pathLength:0,transition:{duration:0}},changes:{pathLength:1,transition:{duration:.4,delay:.5}}};function tc(t){const{status:e}=t;return e?n("svg",{width:"1em",height:"1em",viewBox:"0 0 25 25",fill:"none",stroke:"currentColor",strokeWidth:"1.2","data-sanity-icon":"",children:x(Ee.g,{variants:qr,initial:e,animate:e,children:[x(Yr,{"data-rotate":e==="changes"?void 0:"",children:[n(Gr,{variants:Zr,initial:e,animate:e}),n(Ur,{variants:Jr,initial:e,animate:e})]}),n(Kr,{variants:Qr,initial:e,animate:e}),n($r,{variants:ec,initial:e,animate:e})]})}):null}const nc=fe.forwardRef(function(e,o){const{collapsed:s,status:a,lastUpdated:c,...r}=e,l=me(c||"",{minimal:!0}),d=me(c||"",{minimal:!0,agoSuffix:!0}),u=i.useMemo(()=>a==="syncing"?{text:"Saving...",tone:void 0}:a==="changes"?{text:l,tone:"caution"}:a==="saved"?{text:"Saved!",tone:"positive"}:{},[a,l]);return a?n(ke,{placement:"top",portal:!0,disabled:a!=="changes",content:x(J,{padding:3,space:3,children:[n(R,{size:1,weight:"semibold",children:"Review changes"}),x(R,{size:1,muted:!0,children:["Changes saved ",d]})]}),children:n(G,{mode:"bleed",justify:"flex-start",tone:u==null?void 0:u.tone,...r,"data-testid":"review-changes-button",ref:o,children:x(j,{align:"center",children:[n(T,{marginRight:s?0:3,children:n(R,{children:n(tc,{status:a})})}),!s&&n(R,{size:1,weight:"medium",children:u==null?void 0:u.text})]})})}):null}),oc=fe.memo(nc),ac=1e3,sc=3e3,ic=i.memo(function(){var e;const{changesOpen:o,documentId:s,documentType:a,editState:c,onHistoryClose:r,onHistoryOpen:l,timelineStore:d,value:u}=V(),h=_a(s,a),p=u==null?void 0:u._updatedAt,g=(e=c==null?void 0:c.published)==null?void 0:e._updatedAt,m=Boolean(c==null?void 0:c.liveEdit),v=Boolean(c==null?void 0:c.published),y=Boolean(c==null?void 0:c.draft),[w,b]=i.useState(null),f=ze(w),P=!f||(f==null?void 0:f.width)<300,[S,_]=i.useState(null),C=H(d,E=>E.onOlderRevision);i.useEffect(()=>{if(S==="syncing"&&!h.isSyncing){const E=setTimeout(()=>_("saved"),ac);return()=>clearTimeout(E)}if(S==="saved"){const E=setTimeout(()=>_(null),sc);return()=>clearTimeout(E)}},[S,p,h.isSyncing]),i.useLayoutEffect(()=>{_(null)},[s]),i.useLayoutEffect(()=>{h.isSyncing&&_("syncing")},[h.isSyncing,p]);const M=i.useMemo(()=>n(oc,{lastUpdated:p,status:S||(y?"changes":void 0),onClick:o?r:l,disabled:C,selected:o,collapsed:P}),[y,o,r,l,p,C,S,P]),I=i.useMemo(()=>(m||v)&&n(T,{marginRight:1,children:n(Vr,{disabled:C,lastPublished:g,lastUpdated:p,liveEdit:m,collapsed:P})}),[P,g,p,m,v,C]);return x(j,{align:"center","data-ui":"DocumentSparkline",ref:b,children:[I,x(j,{align:"center",flex:1,children:[M,!P&&n(T,{marginLeft:3,children:n(Wr,{})})]})]})}),rc=W(T)(Pn||(Pn=z([`
  min-width: 10em;
  max-width: 16em;
`])));function cc(t){const{actionsBoxRef:e}=t,{badges:o,timelineStore:s}=V(),a=H(s,c=>c.onOlderRevision);return i.useMemo(()=>n(T,{paddingLeft:2,paddingRight:[2,3],paddingY:2,children:x(j,{align:"center",children:[n(T,{flex:[1,2],children:o&&n(ic,{})}),n(rc,{flex:1,marginLeft:[1,3],ref:e,children:a?n(zr,{}):n(jr,{})})]})}),[e,o,a])}function lc(t){const{actionsBoxElement:e,activeIndex:o,children:s,id:a,onActionStart:c,onKeyDown:r,rootRef:l,states:d,...u}=t,h=d[o],p=i.useCallback(g=>{const m=d.filter(y=>y.shortcut&&mt(y.shortcut,g)),v=m[0];if(m.length>1&&console.warn('Keyboard shortcut conflict: More than one document action matches the shortcut "'.concat(v.shortcut,'"')),v&&!v.disabled&&v.onHandle){g.preventDefault(),v.onHandle(),c(d.indexOf(v));return}r&&r(g)},[c,r,d]);return x(Le,{id:a,onKeyDown:p,tabIndex:-1,...u,ref:l,children:[s,h&&h.dialog&&n(xt,{zOffset:"paneFooter",children:n(wt,{dialog:h.dialog,referenceElement:e})})]})}const yo=fe.memo(t=>{const{actionsBoxElement:e,children:o,...s}=t,{actions:a,editState:c}=V(),[r,l]=i.useState(-1),d=i.useCallback(h=>{l(h)},[]),u=i.useMemo(()=>c&&{...c,onComplete:()=>{},revision:void 0},[c]);return!u||!a?null:n(_t,{actionProps:u,actions:a,children:h=>{let{states:p}=h;return n(lc,{...s,activeIndex:r,actionsBoxElement:e,onActionStart:d,states:p,children:o})}})});yo.displayName="DocumentActionShortcuts";const Mn=320,Dn=600,Rn=320,On=["fixed","absolute"],dc=W(wa)(xn||(xn=z([`
  flex: 1;
  display: flex;
  min-height: 0;
  min-width: 0;
`]))),Sc=i.memo(function(e){const{name:o}=Ae();return n(Fn,{name:e.pane.source||o,children:n(uc,{...e})})});function uc(t){var e;const{pane:o,paneKey:s}=t,{resolveNewDocumentOptions:a}=Ae().document,c=Ce(),r=pc(o.options,c.params),{documentType:l,isLoaded:d}=Ca(r.id,r.type),u=i.useMemo(()=>a({type:"global"}),[a]),[h,p]=Ia({templateItems:u}),g=d&&!p,m=i.useMemo(()=>g&&l&&r.type!==l?hc(t,r,l):t,[t,l,g,r]),{ReferenceChildLink:v,handleEditReference:y,groupIndex:w,routerPanesState:b}=c,f=((e=b[w+1])==null?void 0:e[0].params)||{},P=b.length,{parentRefPath:S}=f,_=i.useMemo(()=>S?{path:Pe(S),state:w>=P-1?"none":w>=P-2?"selected":"pressed"}:{path:[],state:"none"},[S,w,P]);return r.type==="*"&&!g?n(Se,{flex:2.5,minWidth:320,paneKey:s,title:"Loading document…"}):l?n(lo,{...m,children:n(Ea,{EditReferenceLinkComponent:v,onEditReference:y,initialValueTemplateItems:h,activePath:_,children:n(mc,{})})},l):n(co,{flex:2.5,minWidth:320,paneKey:s,title:n(F,{children:"The document was not found"}),children:n(J,{space:4,children:x(R,{as:"p",children:["The document type is not defined, and a document with the ",n("code",{children:r.id})," ","identifier could not be found."]})})})}function pc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o=zn();return i.useMemo(()=>{if(t.type&&t.type!=="*")return t;const s=t.template||e.template,a=s?o.find(r=>r.id===s):void 0,c=a==null?void 0:a.schemaType;return c?{...t,type:c}:t},[t,e.template,o])}function hc(t,e,o){return{...t,pane:{...t.pane,options:{...e,type:o}}}}function mc(){const{changesOpen:t,documentType:e,onFocus:o,onPathOpen:s,onHistoryOpen:a,onKeyUp:c,inspectOpen:r,paneKey:l,schemaType:d,value:u}=V(),{features:h}=se(),{collapsed:p}=Vn(),g=ka(),[m,v]=i.useState(null),[y,w]=i.useState(null),[b,f]=i.useState(null),[P,S]=i.useState(null),_=ze(y),C=_==null?void 0:_.height,M=i.useMemo(()=>n(Er,{footerHeight:C||null,isInspectOpen:r,rootElement:m,setDocumentPanelPortalElement:S}),[C,m,r]),I=i.useMemo(()=>n(bt,{__unstable_elements:{documentPanelPortalElement:P},children:n(Ut,{position:On,zOffset:g.portal,children:n(Ta,{ref:w,children:n(cc,{actionsBoxRef:f})})})}),[P,g.portal]),E=i.useMemo(()=>!h.reviewChanges||!t?null:n(vt,{element:m,children:n(Qi,{})}),[t,h.reviewChanges,m]),O=i.useCallback(N=>{s(N),o(N)},[s,o]),D=i.useMemo(()=>d?x(F,{children:[n(Ut,{position:On,zOffset:g.portal,children:n(j,{direction:"column",flex:1,height:p?void 0:"fill",children:x(dc,{"data-testid":"change-connector-root",isReviewChangesOpen:t,onOpenReviewChanges:a,onSetFocus:O,children:[M,E]})})}),I,n(Ii,{})]}):n(co,{flex:2.5,minWidth:320,paneKey:l,title:x(F,{children:["Unknown document type: ",n("code",{children:e})]}),tone:"caution",children:x(J,{space:4,children:[e&&x(R,{as:"p",children:["This document has the schema type ",n("code",{children:e}),", which is not defined as a type in the local content studio schema."]}),!e&&n(R,{as:"p",children:"This document does not exist, and no schema type was specified for it."}),Ma]})}),[d,g.portal,p,t,a,O,M,E,I,l,e,u]),B=t?Dn+Rn:Dn,L=t?Mn+Rn:Mn;return n(yo,{actionsBoxElement:b,currentMinWidth:B,"data-testid":"document-pane",flex:2.5,id:l,minWidth:L,onKeyUp:c,rootRef:v,children:D})}function fc(){return n(te,{height:"fill",children:n(j,{align:"center",height:"fill",justify:"center",padding:4,sizing:"border",children:n(Ie,{width:0,children:n(te,{padding:4,radius:2,shadow:1,tone:"caution",children:x(j,{children:[n(T,{children:n(R,{size:1,children:n(gt,{})})}),x(J,{flex:1,marginLeft:3,space:3,children:[n(R,{as:"h1",size:1,weight:"bold",children:"No document types"}),n(R,{as:"p",muted:!0,size:1,children:"Please define at least one document type in your schema."}),n(R,{as:"p",muted:!0,size:1,children:n("a",{href:"https://www.sanity.io/docs/create-a-schema-and-configure-sanity-studio",target:"_blank",rel:"noreferrer",children:"Learn how to add a document type →"})})]})]})})})})})}const gc=W(ei)(Sn||(Sn=z([`
  min-height: 100%;
  min-width: 320px;
`]))),bc=mt("mod+s"),vc=i.memo(function(e){let{onPaneChange:o}=e;var s;const{push:a}=we(),c=jn(),{layoutCollapsed:r,setLayoutCollapsed:l}=se(),{paneDataItems:d,resolvedPanes:u}=di(),h=pt(i.useCallback(w=>typeof w.intent=="string",[])),[p,g]=i.useState(null),m=i.useCallback(()=>l(!0),[l]),v=i.useCallback(()=>l(!1),[l]);return i.useEffect(()=>{u.length&&o(u)},[o,u]),i.useEffect(()=>{const w=b=>{bc(b)&&(b.preventDefault(),a({closable:!0,id:"auto-save-message",status:"info",title:"Your work is automatically saved!",duration:4e3}))};return window.addEventListener("keydown",w),()=>window.removeEventListener("keydown",w)},[a]),((s=c._original)==null?void 0:s.types.some(Da))?x(bt,{element:p||null,children:[x(gc,{flex:1,height:r?void 0:"fill",minWidth:512,onCollapse:m,onExpand:v,children:[d.map(w=>{let{active:b,childItemId:f,groupIndex:P,itemId:S,key:_,pane:C,index:M,params:I,path:E,payload:O,siblingIndex:D,selected:B}=w;return n(i.Fragment,{children:C===at?n(Se,{paneKey:_,path:E,selected:B}):n(Si,{active:b,groupIndex:P,index:M,pane:C,childItemId:f,itemId:S,paneKey:_,params:I,payload:O,path:E,selected:B,siblingIndex:D})},"".concat(C===at?"loading":C.type,"-").concat(M))}),d.length<=1&&h&&n(Se,{paneKey:"intent-resolver"})]}),n("div",{"data-portal":"",ref:g})]}):n(fc,{})});function yc(t){let{tool:{options:e}}=t;const{unstable_sources:o}=os(),[s]=o,{source:a,defaultDocumentNode:c,structure:r}=e||{};i.useEffect(()=>(Je([]),()=>Je([])),[]);const[{error:l},d]=i.useState({error:null});return l?n(gi,{error:l}):n(as,{onCatch:d,children:n(Fn,{name:a||s.name,children:x(ss,{defaultDocumentNode:c,structure:r,children:[n(vc,{onPaneChange:Je}),n(hi,{})]})})})}var _c=Object.freeze({__proto__:null,default:yc});export{so as Delay,Sc as DocumentPane,lo as DocumentPaneProvider,_c as index,se as useDeskTool,tr as useDeskToolSetting};
